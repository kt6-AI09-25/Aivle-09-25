<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div class="recent-activities">
  <h3>최근 활동</h3>
  <ul id="activityList" class="activities-list">
    <li>로딩 중...</li>
  </ul>
</div>


<script>
  async function fetchRecentActivities() {
      try {
          const response = await fetch('/admin/recent-activities');
          if (!response.ok) throw new Error('데이터를 불러오는 데 실패했습니다.');

          const activities = await response.json();
          const activityList = document.getElementById("activityList");
          activityList.innerHTML = ""; // 기존 목록 초기화

          if (activities.length === 0) {
              activityList.innerHTML = "<li>최근 활동 내역이 없습니다.</li>";
              return;
          }

          activities.forEach(activity => {
              const listItem = document.createElement("li");
              let link = activity.targetId ? `<a href="/posts/${activity.targetId}">게시글 보기</a>` : "";
              listItem.innerHTML = `<strong>${activity.username}</strong>님이 ${activity.action} ${link} - <span class="activity-time">${activity.createdAt}</span>`;
              activityList.appendChild(listItem);
          });
      } catch (error) {
          console.error("최근 활동 불러오기 실패:", error);
          document.getElementById("activityList").innerHTML = "<li>활동 내역을 불러오는 중 오류가 발생했습니다.</li>";
      }
  }

  // 페이지 로딩 시 데이터 가져오기
  document.addEventListener("DOMContentLoaded", fetchRecentActivities);
</script>

</body>
</html>